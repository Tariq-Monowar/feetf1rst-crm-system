generator client {
  provider = "prisma-client-js"
}

// The datasource `url` property is deprecated in Prisma 5+. Connection info should be moved
// to prisma.config.ts, and the schema only retains the provider.
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String  @id @default(uuid())
  partnerId String?

  name String?

  email          String  @unique
  password       String?
  secretPassword String?
  image          String?
  role           Role    @default(ADMIN)

  phone         String?
  absenderEmail String?

  busnessName String? // Geschäftspartner Name / Account Name

  hauptstandort String[] // Hauptstandort, main location
  // weitereStandorte String[] // Other locations

  createdAt        DateTime              @default(now()) @map("created_at")
  updatedAt        DateTime              @updatedAt
  suggestions      SuggestionFeetf1rst[]
  sentMessages     Message[]             @relation("sent_messages")
  receivedMessages Message[]             @relation("received_messages")

  appointments           appointment[]
  improvementSuggestions ImprovementSuggestion[]
  messageVisibility      MessageVisibility[]
  partnerOrders          customerOrders[]        @relation("PartnerOrders")
  employees              Employees[]
  customer_price         customer_price[]
  bestellubersicht       Bestellubersicht?

  // Mandatory one-to-one relationship
  workshopNote                WorkshopNote?
  stores                      Stores[]
  StoresHistory               StoresHistory[]
  custom_shafts               custom_shafts[]
  // massschuheOrders massschuhe_order[]
  massschuheOrders            massschuhe_order[]
  controllQuestions           controllQuestions[]
  customerOrdersHistories     customerOrdersHistory[]
  massschuheOrderHistories    massschuhe_order_history[]
  supplyStatuses              supplyStatus[]
  versorgungens               Versorgungen[]
  customerSettings            customer_settings?
  customerVersorgungens       customer_versorgungen[]
  storeOrderOverviews         StoreOrderOverview[]
  partnersSettings            partners_settings?
  customerRequirements        customer_requirements[]
  featureAccess               FeatureAccess?
  notifications               notification[]
  storeLocations              store_location[]
  customers                   customers[]
  orderSettings               order_settings?
  // massschuheOrderAdmin1s   massschuhe_order_admin_1[]
  adminOrderTransitions       admin_order_transitions[]
  adminStoreTrackings         admin_store_tracking[]
  partnerConversations        partner_conversation[]
  partnerConversationMembers  partner_conversation_members[]
  partnerConversationMessages partner_conversation_message[]
  partnerPayouts              partner_payout[]
  courierContacts             CourierContact[]
  customModels                custom_models[]
  accountInfos                accountInfo[]
  employeeFeatureAccess       employee_feature_access[]
  feetf1RstShopInterests      feetf1rst_shop_interests[]
  stockMaterials              stock_material[]
  shoeOrders                  shoe_order[]
  diagnosisStatuses           diagnosis_status[]

  @@index([name]) // For search optimization
  @@index([email]) // Already unique, but explicit index helps
  @@map("users")
}

model accountInfo {
  id String @id @default(uuid())

  vat_country String?
  vat_number  String?

  barcodeLabel String?

  /**
   * 1. bankName   String?
   * 2. bankNumber String?
   */
  bankInfo        Json?
  two_factor_auth Boolean @default(false)

  //relation
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId String
}

model ucode {
  id         String   @id @default(uuid())
  otp        String
  name       String?
  email      String   @unique
  expired_at DateTime
  createdAt  DateTime @default(now())
}

model partner_payout {
  id String @id @default(uuid())

  partnerId String
  partner   User   @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  bankName   String?
  bankNumber String?
  bic        String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Product {
  id              String   @id @default(uuid())
  name            String?
  brand           String?
  Category        String?
  Sub_Category    String?
  typeOfShoes     String?
  productDesc     String?
  price           Float?
  availability    Boolean?
  offer           Float?
  size            Json?
  feetFirstFit    String?
  footLength      String?
  technicalData   String?
  characteristics Int[]
  Company         String?
  gender          Gender?
  question        Json?
  colors          Color[]
  createdAt       DateTime @default(now())

  @@index([id, name])
}

model Color {
  id        String  @id @default(uuid())
  colorName String
  colorCode String
  product   Product @relation(fields: [productId], references: [id], onDelete: Cascade)
  productId String
  images    Image[]
}

model Image {
  id        String   @id @default(uuid())
  url       String
  color     Color    @relation(fields: [colorId], references: [id], onDelete: Cascade)
  colorId   String
  createdAt DateTime @default(now())
}

model appointment {
  id            String   @id @default(uuid())
  customer_name String
  time          String
  date          DateTime
  reason        String
  /// assignedTo মানে হচ্ছে employe name
  assignedTo    String
  employeId     String?
  duration      Float?

  details      String?
  isClient     Boolean?
  userId       String
  reminder     Int?     @default(0)
  reminderSent Boolean  @default(false)

  customerId String?
  user       User    @relation(fields: [userId], references: [id], onDelete: Cascade)

  appointmentEmployees AppointmentEmployee[]

  createdAt DateTime @default(now())

  @@map("appointment")
}

model AppointmentEmployee {
  id            String @id @default(uuid())
  appointmentId String

  appointment appointment @relation(fields: [appointmentId], references: [id], onDelete: Cascade)
  employeeId  String

  employee   Employees @relation(fields: [employeeId], references: [id], onDelete: Cascade)
  assignedTo String // Employee name for this appointment

  createdAt DateTime @default(now())

  @@unique([appointmentId, employeeId])
  @@index([appointmentId])
  @@index([employeeId])
  @@map("appointment_employee")
}

model SuggestionFeetf1rst {
  id String @id @default(uuid())

  reason     String
  name       String
  phone      String
  suggestion String
  userId     String
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  createdAt  DateTime @default(now())
}

// name, email, firma, phone, suggestion
model ImprovementSuggestion {
  id         String   @id @default(uuid())
  suggestion String
  category   String?
  image      String[]

  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId String

  createdAt DateTime @default(now())
}

model Message {
  id             String              @id @default(uuid())
  subject        String
  content        String
  senderId       String
  sender         User                @relation("sent_messages", fields: [senderId], references: [id], onDelete: Cascade)
  recipientId    String?
  recipient      User?               @relation("received_messages", fields: [recipientId], references: [id], onDelete: SetNull)
  recipientEmail String // For non-registered recipients
  isFavorite     Boolean             @default(false)
  isDeleted      Boolean             @default(false)
  recipientType  RecipientType?
  createdAt      DateTime            @default(now())
  updatedAt      DateTime            @updatedAt
  visibilities   MessageVisibility[]

  @@index([senderId])
  @@index([recipientId])
  @@map("messages")
}

enum RecipientType {
  USER
  CUSTOMER
  EXTERNAL
}

model MessageVisibility {
  id         String   @id @default(uuid())
  messageId  String
  userId     String
  isDeleted  Boolean  @default(false)
  isFavorite Boolean  @default(false)
  message    Message  @relation(fields: [messageId], references: [id], onDelete: Cascade)
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  @@unique([messageId, userId])
  @@index(messageId)
  @@index(userId)
  @@index([createdAt])
  @@map("message_visibilities")
}

enum Role {
  ADMIN
  USER
  PARTNER
  EMPLOYEE
}

enum Gender {
  MALE
  FEMALE
  UNISEX
}

//-------------------------------------------------

model Employees {
  id String @id @default(uuid())

  accountName String

  employeeName    String
  email           String?
  password        String?
  financialAccess Boolean @default(false)
  jobPosition     String?
  image           String?
  role            Role    @default(EMPLOYEE)

  partnerId String
  user      User   @relation(fields: [partnerId], references: [id], onDelete: SetNull)

  WorkshopNote WorkshopNote?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  appointmentEmployees        AppointmentEmployee[]
  massschuheOrders            massschuhe_order[]
  customerOrdersHistories     customerOrdersHistory[]
  massschuheOrderHistories    massschuhe_order_history[]
  customerOrders              customerOrders[]
  partnerConversationMembers  partner_conversation_members[]
  partnerConversationMessages partner_conversation_message[]
  employeeFeatureAccess       employee_feature_access[]
  leave_application           leave_application[]

  @@index([partnerId]) // createOrder: find first employee by partner
  @@index([createdAt])
}

model leave_application {
  id String @id @default(uuid())

  employeeId String
  employee   Employees @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  reason leave_application_reason?
  date   DateTime
  type   leave_application_type    @default(FULL)

  status leave_application_status @default(Pending)

  createdAt DateTime @default(now())

  @@index([employeeId])
  @@index([createdAt])
  @@index([date])
  @@map("leave_application")
}

enum leave_application_reason {
  UR
  KR
  FO
  DH
  FT
  SO
  SA
  DG
  OTHER
}

enum leave_application_type {
  HALF
  FULL
}

enum leave_application_status {
  Pending
  Approved
  Rejected
}

model WorkshopNote {
  id String @id @default(uuid())

  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId String @unique

  employeeId String?    @unique
  employee   Employees? @relation(fields: [employeeId], references: [id], onDelete: SetNull)

  employeeName   String?
  completionDays String   @default("5 Werktage")
  pickupLocation String[]
  sameAsBusiness Boolean  @default(true)

  showCompanyLogo    Boolean @default(true)
  autoShowAfterPrint Boolean @default(true)
  autoApplySupply    Boolean @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([employeeId])
  @@index([createdAt])
}

model Versorgungen {
  id   String @id @default(uuid())
  name String

  /// Rohling Hersteller is come form "Stores in  produktname" field
  rohlingHersteller String

  /// artikel Hersteller is come form "Stores in  hersteller" field
  artikelHersteller String
  versorgung        String

  material String[]

  // langenempfehlung Json?

  // status           versorgungenStatus
  diagnosis_status versorgungenDiagnosisStatus[] @default([])

  // createdBy String
  updatedBy String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  partnerId String?
  partner   User?   @relation(fields: [partnerId], references: [id], onDelete: SetNull)

  storeId String?
  store   Stores? @relation(fields: [storeId], references: [id], onDelete: SetNull)

  supplyStatusId String?
  supplyStatus   supplyStatus? @relation(fields: [supplyStatusId], references: [id], onDelete: SetNull)
  // massschuheOrders massschuhe_order[]

  customerOrders customerOrders[]

  supplyType supplyType @default(public)

  @@index([id, name])
  @@index([createdAt])
}

enum supplyType {
  private
  public
}

model supplyStatus {
  id String @id @default(uuid())

  name        String?
  description String?

  // Final customer price (VAT included)
  price Float?

  // VAT rate (e.g. 20 for 20%) government VAT
  vatRate Float @default(0)

  // Your margin percentage (software commission) (not VAT)
  profitPercentage Float @default(0)

  image String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  partnerId String
  partner   User   @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  versorgungen          Versorgungen[]
  customerVersorgungens customer_versorgungen[]

  @@index([partnerId])
  @@index([createdAt])
  @@index([name])
  @@index([image])
  @@index([name, price, image])
  @@map("supply_status")
}

enum versorgungenStatus {
  Alltagseinlagen
  Sporteinlagen
  Businesseinlagen
}

enum versorgungenDiagnosisStatus {
  HAMMERZEHEN_KRALLENZEHEN
  MORTON_NEUROM
  FUSSARTHROSE
  STRESSFRAKTUREN_IM_FUSS
  DIABETISCHES_FUSSSYNDROM
  HOHLFUSS
  KNICKFUSS
  KNICK_SENKFUSS
  HALLUX_VALGUS
  HALLUX_RIGIDUS
  PLANTARFASZIITIS
  FERSENSPORN
  SPREIZFUSS
  SENKFUSS
  PLATTFUSS
}

model diagnosis_status {
  id        String   @id @default(uuid())
  name      String
  createdAt DateTime @default(now())

  //relation with partner
  partnerId String?
  partner   User?   @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  @@index([name])
  @@index([id])
  @@index([partnerId])
}

model customer_price {
  id                 String @id @default(uuid())
  fußanalyse        Float?
  einlagenversorgung Float?

  partnerId String
  partner   User   @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model customer_settings {
  id String @id @default(uuid())

  partnerId String @unique
  user      User   @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  cover_types        String[]
  laser_print_prices Json?

  createdAt      DateTime         @default(now())
  updatedAt      DateTime         @updatedAt
  storeLocations store_location[]
}

model store_location {
  id String @id @default(uuid())

  partnerId String?
  partner   User?   @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  isPrimary Boolean @default(false)

  address     String?
  description String?

  createdAt           DateTime           @default(now())
  updatedAt           DateTime           @updatedAt
  customerSettings    customer_settings? @relation(fields: [customer_settingsId], references: [id])
  customer_settingsId String?

  @@index([partnerId])
  @@index([createdAt])
  @@index([updatedAt])
  @@index([id])
}

model customers {
  id             String  @id @default(uuid())
  customerNumber Int // Unique per partnerId, not globally
  vorname        String?
  nachname       String?
  email          String? @unique
  // telefonnummer  String?
  wohnort        String?

  gender       String?
  geburtsdatum String?
  straße      String?
  land         String?
  ort          String?
  telefon      String?

  screenerFile screener_file[]

  // this all data come form a single csv file
  fusslange1   String? //B58   (.csv)
  fusslange2   String? //C58   (.csv)
  fussbreite1  String? //B73   (.csv)
  fussbreite2  String? //C73   (.csv)
  kugelumfang1 String? //B102  (.csv)
  kugelumfang2 String? //C102  (.csv)
  rist1        String? //B105  (.csv)
  rist2        String? //C105  (.csv)
  zehentyp1    String? //B136  (.csv)
  zehentyp2    String? //C136  (.csv)
  archIndex1   String? //B120  (.csv)
  archIndex2   String? //C120  (.csv)

  partnerId String
  partner   User    @relation(fields: [partnerId], references: [id], onDelete: Cascade)
  updatedBy String?

  // Relation to KundenHistorie
  customerHistorie customerHistorie[]

  // Relation to UserAnswer
  einlagenAnswers       einlagenAnswers[]
  versorgungen          customer_versorgungen[] @relation("customerVersorgungen")
  ausfuhrliche_diagnose String?
  customerOrders        customerOrders[]
  custom_shafts         custom_shafts[]

  kundeSteuernummer String? // Kunde Steuernummer
  diagnose          String? // Diagnose
  kodexeMassschuhe  String? // Kodexe Massschuhe
  kodexeEinlagen    String? // Kodexe Einlagen
  sonstiges         String? // Sonstiges

  fußanalyse        Float? //ইনসোল $
  einlagenversorgung Float? //Foot analysis $

  billingType String? // Billing type: insurance (Krankenkasse_*) or private (Privat_*)

  createdAt        DateTime           @default(now())
  updatedAt        DateTime           @updatedAt
  StoresHistory    StoresHistory[]
  customer_files   customer_files[]
  // massschuheOrders massschuhe_order[]
  massschuheOrders massschuhe_order[]

  shoeAnswers              shoeAnswers[]
  insolesAnswers           insolesAnswers[]
  massschuheOrderHistories massschuhe_order_history[]
  courierContacts          CourierContact[]
  customModels             custom_models[]
  adminOrderTransitions    admin_order_transitions[]
  shoeOrders               shoe_order[]

  @@unique([partnerId, customerNumber]) // Unique per partner
  @@index([partnerId, vorname, nachname]) // Search: filter by partner + order by name
  @@index([vorname, nachname])
  // @@index([telefonnummer])
  @@index([wohnort])
  @@index([email])
  @@index([telefon]) // For search optimization
  @@index([ort]) // For search optimization
  @@index([land]) // For search optimization
  @@index([id, vorname])
  @@index([id, email])
  @@index([createdAt])
  @@index([partnerId])
}

model customer_requirements {
  id String @id @default(uuid())

  partnerId String @unique
  partner   User   @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  vorname      Boolean @default(false)
  nachname     Boolean @default(false)
  geburtsdatum Boolean @default(false)
  email        Boolean @default(false)
  telefon      Boolean @default(false)
  adresse      Boolean @default(false)
  land         Boolean @default(false)
  billingType  Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([partnerId])
  @@index([createdAt])
  @@index([updatedAt])
  @@index([id])
}

model shoeAnswers {
  id         String    @id @default(uuid())
  customerId String
  customer   customers @relation(fields: [customerId], references: [id], onDelete: Cascade)
  answer     Json
}

model insolesAnswers {
  id         String    @id @default(uuid())
  customerId String
  customer   customers @relation(fields: [customerId], references: [id], onDelete: Cascade)
  answer     Json
}

model controllQuestions {
  id String @id @default(uuid())

  partnerId String @unique
  partner   User   @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  controlShoeQuestions    Int[]
  controlInsolesQuestions Int[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([partnerId])
  @@index([createdAt])
  @@index([updatedAt])
  @@index([id])
}

model screener_file {
  id         String    @id @default(uuid())
  customerId String
  customer   customers @relation(fields: [customerId], references: [id], onDelete: Cascade)

  //------------------------------------------------------
  picture_10 String? //Fersenneigung left (image)
  picture_23 String? //Plantaransicht left (image)

  paint_24 String? //Paint Fersenneigung left (image)
  paint_23 String? //Paint Plantaransicht left (image)
  //------------------------------------------------------

  threed_model_left  String? //3D-Model left   (.stl)
  picture_17         String? //Sohlen Index left (image)
  picture_11         String? //Fersenneigung right (image)
  picture_24         String? //Plantaransich right  (image)
  threed_model_right String? //3D-Model right   .stl
  picture_16         String? //Sohlen Index right   (image)
  csvFile            String?

  // this all data come form a single csv file
  fusslange1   String? //B58   (.csv)
  fusslange2   String? //C58   (.csv)
  fussbreite1  String? //B73   (.csv)
  fussbreite2  String? //C73   (.csv)
  kugelumfang1 String? //B102  (.csv)
  kugelumfang2 String? //C102  (.csv)
  rist1        String? //B105  (.csv)
  rist2        String? //C105  (.csv)
  zehentyp1    String? //B136  (.csv)
  zehentyp2    String? //C136  (.csv)
  archIndex1   String? //B120  (.csv)
  archIndex2   String? //C120  (.csv)

  createdAt      DateTime         @default(now())
  updatedAt      DateTime         @updatedAt
  customerOrders customerOrders[]

  @@index([customerId])
  @@index([id])
  @@index([createdAt])
}

model customer_files {
  id         String    @id @default(uuid())
  customerId String
  customer   customers @relation(fields: [customerId], references: [id], onDelete: Cascade)
  url        String
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt

  @@index([customerId])
  @@index([createdAt])
}

model einlagenAnswers {
  id         String           @id @default(uuid())
  customerId String
  customer   customers        @relation(fields: [customerId], references: [id], onDelete: Cascade)
  category   QuestionCategory
  questionId String
  answer     Json

  @@unique([customerId, questionId])
  @@index([customerId])
  @@index([category])
  @@index([questionId])
}

enum QuestionCategory {
  BUSINESSEINLAGE
  ALLTAGSEINLAGE
  SPORTEINLAGE
}

model customerHistorie {
  id         String        @id @default(uuid())
  customerId String
  customer   customers     @relation(fields: [customerId], references: [id], onDelete: Cascade)
  category   EventCategory

  date DateTime?

  // make a relation with customerOrders model
  orderId String?
  order   customerOrders? @relation("OrderCustomerHistorie", fields: [orderId], references: [id], onDelete: SetNull)

  url       String?
  methord   String?
  paymentIs String?
  eventId   String?

  note        String?
  system_note String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([customerId])
  @@index([eventId])
  @@index([category])
  @@index([createdAt])
}

enum EventCategory {
  Notizen //Notes
  Bestellungen //Orders
  Leistungen //Services
  Rechnungen //Invoices
  Zahlungen //Payments
  Emails //Emails
  Termin //Appointment
}

model customer_versorgungen {
  id   String @id @default(uuid())
  name String

  /// Rohling Hersteller is come form "Stores in  produktname" field
  rohlingHersteller String

  /// artikel Hersteller is come form "Stores in  hersteller" field
  artikelHersteller String
  versorgung        String

  material String[]

  // status           versorgungenStatus
  diagnosis_status versorgungenDiagnosisStatus[] @default([])

  status             versorgungenStatus
  cover_types        String?
  laser_print_prices Float?

  // createdBy String
  updatedBy String?

  partnerId String?
  partner   User?   @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  storeId String?
  store   Stores? @relation(fields: [storeId], references: [id], onDelete: Cascade)

  // supplyStatusId String?
  // supplyStatus   supplyStatus? @relation(fields: [supplyStatusId], references: [id], onDelete: Cascade)
  // // massschuheOrders massschuhe_order[]

  customerOrders customerOrders[]

  customerId String
  customer   customers @relation("customerVersorgungen", fields: [customerId], references: [id], onDelete: Cascade)

  createdAt      DateTime      @default(now())
  updatedAt      DateTime      @updatedAt
  supplyStatus   supplyStatus? @relation(fields: [supplyStatusId], references: [id])
  supplyStatusId String?

  @@index([id, name])
  @@index([customerId])
  @@index([createdAt])
}

model customerOrders {
  id String @id @default(uuid())

  orderNumber Int // Unique per partner, not globally

  fußanalyse        Float?
  einlagenversorgung Float?
  totalPrice         Float

  // orderStatus  String?
  statusUpdate DateTime?
  invoice      String?

  ausführliche_diagnose String?
  versorgung_laut_arzt   String?
  einlagentyp            String?
  überzug               String?
  quantity               Int?
  versorgung_note        String? //Hast du sonstige Anmerkungen oder Notizen zur Versorgung... ?
  schuhmodell_wählen    String? //জুতার মডেল নির্বাচন করুন ম্যানুয়ালি লিখুন (ব্র্যান্ড + মডেল + সাইজ)
  kostenvoranschlag      Boolean? @default(false)

  discount Float?

  // Privet          String? // Bezahlt - string naw
  // bezahltInsurance       String? // Bezahlt - string naw

  // Werkstattzettel (inline fields to avoid extra API)
  kundenName    String?
  auftragsDatum DateTime?
  wohnort       String?
  telefon       String?
  email         String?

  geschaeftsstandort Json? // { title: string, description?: string }
  pickUpLocation     Json? // { title: string, description?: string }
  addonPrices        Float? @default(0) // { title: string, description?: string }

  mitarbeiter       String?
  fertigstellungBis DateTime? // pickup date
  versorgung        String?

  fussanalysePreis        Float?
  einlagenversorgungPreis Float?

  barcodeLabel     String?
  barcodeCreatedAt DateTime?

  cashNites  String?
  orderNotes String?

  bezahlt             paymnentStatus?
  insuranceTotalPrice Float?          @default(0)

  orderStatus OrderStatus @default(Warten_auf_Versorgungsstart)
  priority    Priority?   @default(Normal)
  type        StoreType   @default(rady_insole)

  //---------------------------------------------------------
  productId String?          @unique
  product   customerProduct? @relation(fields: [productId], references: [id])

  customerId String?
  customer   customers? @relation(fields: [customerId], references: [id], onDelete: SetNull)

  partnerId String?
  partner   User?   @relation(fields: [partnerId], references: [id], onDelete: SetNull, name: "PartnerOrders")

  versorgungId String? // Add this
  Versorgungen Versorgungen? @relation(fields: [versorgungId], references: [id], onDelete: SetNull)

  screenerId   String?
  screenerFile screener_file? @relation(fields: [screenerId], references: [id], onDelete: SetNull)

  // werkstattEmployeeId String?
  employeeId String?
  employee   Employees? @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  storeId String?
  store   Stores? @relation(fields: [storeId], references: [id], onDelete: SetNull)

  customer_versorgungenId String?
  customerVersorgungen    customer_versorgungen? @relation(fields: [customer_versorgungenId], references: [id])

  //-----------------------------------------------------------------------------------
  customerHistories       customerHistorie[]       @relation("OrderCustomerHistorie")
  customerOrdersHistories customerOrdersHistory[]
  StoresHistory           StoresHistory[]          @relation("OrderStoresHistory")
  customerOrderInsurances customerOrderInsurance[]

  //======================FOR Sonstiges (bibid or other service)===========================
  service_name       String?
  sonstiges_category String?
  // Employees relation with employee
  // quantity
  net_price          Float?
  //discount
  vatRate            Float?
  //total_price
  //versorgung_note

  orderCategory OrderCategory @default(insole)
  //============================================================== 

  createdAt       DateTime          @default(now())
  updatedAt       DateTime          @updatedAt
  ordersFeedbacks ordersFeedback[]
  insoleStandards insole_standard[]

  @@unique([partnerId, orderNumber]) // Unique per partner
  @@index([customerId])
  @@index([partnerId])
  @@index([partnerId, orderStatus, fertigstellungBis]) // getPickupCalculation: single-scan raw query
  @@index([partnerId, orderNumber]) // createOrder: getNextOrderNumberForPartner
  @@index([createdAt])
  @@index([totalPrice])
  @@index([customerId, partnerId])
  @@index([customerId, createdAt])
}

enum OrderCategory {
  insole
  sonstiges
}

enum paymnentStatus {
  Privat_Bezahlt //cash paymnant success
  Privat_offen //cash paymnant pending

  Krankenkasse_Ungenehmigt
  Krankenkasse_Genehmigt
}

// enum KrankenkasseStatus {
//   Krankenkasse_Ungenehmigt
//   Krankenkasse_Genehmigt
// }

enum Priority {
  Dringend
  Normal
}

model customerOrderInsurance {
  id String @id @default(uuid())

  orderId String
  order   customerOrders @relation(fields: [orderId], references: [id], onDelete: Cascade)

  price       Float?
  description Json?

  vat_country String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([orderId])
  @@index([price])
  @@index([description])
  @@index([createdAt])
  @@index([updatedAt])
}

enum vat_countrys {
  Pending
  Approved
  Rejected
}

model customerOrdersHistory {
  id String @id @default(uuid())

  orderId String
  order   customerOrders @relation(fields: [orderId], references: [id], onDelete: Cascade)

  statusFrom OrderStatus?
  statusTo   OrderStatus?

  // Add this field to track payment status changes
  paymentFrom     paymnentStatus?
  paymentTo       paymnentStatus?
  isPrementChange Boolean         @default(false)

  //relation with user
  partnerId String?
  partner   User?   @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  //relation with paetner employee
  employeeId String?
  employee   Employees? @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  note String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model ordersFeedback {
  id String @id @default(uuid())

  orderId String?
  order   customerOrders? @relation(fields: [orderId], references: [id], onDelete: SetNull)

  massschuheOrderId String?
  massschuheOrder   massschuhe_order? @relation(fields: [massschuheOrderId], references: [id], onDelete: SetNull)

  feedbackFor FeedbackFor? @default(insole)

  react FeedbackReact?
  note  String?
  image String?

  createdAt DateTime @default(now())
}

enum FeedbackFor {
  insole
  shoes
}

enum FeedbackReact {
  Like
  Dislike
}

model customerProduct {
  id                String @id @default(uuid())
  name              String
  rohlingHersteller String
  artikelHersteller String
  versorgung        String
  material          String
  langenempfehlung  Json

  status           versorgungenStatus
  diagnosis_status versorgungenDiagnosisStatus[] @default([])

  order customerOrders?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([name])
  @@index([status])
  @@index([diagnosis_status])
  @@index([rohlingHersteller])
  @@index([artikelHersteller])
  @@index([createdAt])
  @@index([status, diagnosis_status])
}

enum OrderStatus {
  Warten_auf_Versorgungsstart //1, 2
  In_Fertigung //1
  Verpacken_Qualitätssicherung //1, 2
  Abholbereit_Versandt //1,2
  Ausgeführt //1,2

  // milling_block flow
  Warten_auf_Fraesvorgang //2
  Fraesvorgang //2
  Feinschliff //2
  In_Modellierung //2
}

model insole_standard {
  id String @id @default(uuid())

  isFavorite Boolean @default(false)
  name       String?
  left       Float   @default(0)
  right      Float   @default(0)

  customerOrdersId String
  customerOrders   customerOrders @relation(fields: [customerOrdersId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
}

/**
 * Store model---------------------------------------------------------
 * @samaty{
 * -এখানে অ্যাাডমিনের কাছেই সব স্টর থাকবে পার্টনাররা এখান থেকে স্টর কিনে নিবে
 * -কিনে নেওইয়ার সমইয় admin_store রিমভ হইয়ে যাবে na. তার থেকে ডাটা Stores এ ডুকবে
 * -ট্রেক রাখার জন্য admin_store_tracking তৌরি করা হইয়েছে।
 * }
 * ====================================================================
 */

model admin_store {
  /**
   * - এর দুইটা উদ্দেশ্য/
   * 1.অ্যাাডমিন কে এক টা ক্লিন ট্রাংজিকশনের ডাটা বা স্টরি দেওয়া।
   * 2.পার্টনারের ব্যালেন্স ট্রেক করা।
   */
  id String @id @default(uuid())

  image String?
  price Int?
  // length        Float
  // size          String
  brand String?

  productName   String?
  artikelnummer String?
  eigenschaften String?

  /**
   * @rady_insole datatype
   * {
   * "35": {
   * "length": 87,
   * "quantity": 27,
   * "mindestmenge": 70,
   * "auto_order_limit": 92,
   * "auto_order_quantity": 88,
   * "warningStatus": "Niedriger Bestand"
   * }
   * @milling_block datatype
   * hear milling block data is 3 sizes
   * যদি foot_length_mm নির্দিষ্ট Range A-এর মধ্যে থাকে (যেমন 200mm এর নিচে)
   * → Block Size 1
   * যদি foot_length_mm 200mm – 250mm এর মধ্যে থাকে (Range B)
   * → Block Size 2
   * যদি foot_length_mm 250mm এর বেশি হয়
   * → Block Size 3
   * "1": {
   * fix foot length,
   * "quantity": 27,
   * "mindestmenge": 70,
   * "auto_order_limit": 92,
   * "auto_order_quantity": 88,
   * "warningStatus": "Niedriger Bestand"
   * }
   */

  groessenMengen Json?

  stores Stores[]

  type StoreType @default(rady_insole)

  createdAt           DateTime               @default(now())
  updatedAt           DateTime               @updatedAt
  adminStoreTrackings admin_store_tracking[]
  adminStoreHistories admin_store_history[]
}

model brand_store {
  id    String  @id @default(uuid())
  brand String?

  groessenMengen Json?

  type StoreType @default(rady_insole)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([brand, type])
}

model admin_store_tracking {
  id String @id @default(uuid())

  storeId String
  store   Stores @relation(fields: [storeId], references: [id], onDelete: Cascade)

  //relation
  partnerId String
  partner   User   @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  /// Product name
  produktname String

  ///  প্রোডাক্টের প্রস্তুতকারক Manufacturer 
  hersteller String

  /// Article number / SKU
  artikelnummer String

  /// Storage location / warehouse location এটা আসবে ইউজার মডেলের hauptstandort[] এই অ্যাারে অফ স্ট্রিং থেকে
  lagerort String?

  /// Minimum stock level এটা দিয়ে স্টক ওইয়ারনিং দিবে যদি groessenMengen json এর কোন ভেলু এই int এর নিচে নামে তাহলে এটা স্টকে "Niedriger Bestand" এই wormning দবে যদি এই int এর উপরে নামে তাহলে এটা স্টকে "Voller Bestand" এই wormning দবে
  mindestbestand Int?

  /// Sizes & quantities (e.g., {"S": 10, "M": 20, "L": 15})
  groessenMengen Json

  price Float?
  image String?
  type  StoreType @default(rady_insole)

  parcessAt     DateTime     @default(now())
  adminStore    admin_store? @relation(fields: [admin_storeId], references: [id])
  admin_storeId String?
}

model admin_store_history {
  id String @id @default(uuid())

  admin_storeId String
  admin_store   admin_store @relation(fields: [admin_storeId], references: [id], onDelete: Cascade)

  groessenMengen Json?
  price          Float?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Stores {
  id String @id @default(uuid())

  /// Product name
  produktname String //productName

  ///  প্রোডাক্টের প্রস্তুতকারক Manufacturer 
  hersteller String //brand

  /// Article number / SKU
  artikelnummer String //artikelnummer

  /// Storage location / warehouse location এটা আসবে ইউজার মডেলের hauptstandort[] এই অ্যাারে অফ স্ট্রিং থেকে
  lagerort String?

  /// Minimum stock level এটা দিয়ে স্টক ওইয়ারনিং দিবে যদি groessenMengen json এর কোন ভেলু এই int এর নিচে নামে তাহলে এটা স্টকে "Niedriger Bestand" এই wormning দবে যদি এই int এর উপরে নামে তাহলে এটা স্টকে "Voller Bestand" এই wormning দবে
  mindestbestand Int?

  image String?

  /**
   * @groessenMengen এর ডাটা টাইপ
   * "35": {   //এখানে 35 হচ্ছে জুতার সাইজ
   * "length": 87,
   * "quantity": 27,
   * "mindestmenge": 70, //স্টক ওয়ানিং এটা
   * "auto_order_limit": 92,
   * "auto_order_quantity": 88,
   * "warningStatus": "Niedriger Bestand" //এটা mindestmenge এর সাথে সর্পকিতো স্টক ওয়ানিং
   * },
   * এটাই স্টরের মুল বিষয়, আমার কাছে কোন সাইজের কয়টা প্রডাক্ট আছে এখানথেকে আমি জানতে পারবো
   */
  groessenMengen Json

  purchase_price Int //price
  selling_price  Int

  /// এই স্টাটাস ডিপেন্ড করে mindestbestand এর উপর যদি mindestbestand এর উপরে থাকে তাহলে এটা "Voller Bestand" এই স্ট্রিং দিবে যদি mindestbestand এর নিচে থাকে তাহলে এটা "Niedriger Bestand" এই স্ট্রিং দিবে
  Status String?

  create_status CreateStatus? @default(by_admin)

  orthotech Boolean @default(false)
  opannrit  Boolean @default(false)

  /// versorgungen এর সাথে রিলেশন হচ্ছে ID,  Artikelhersteller = hersteller, Rohling Hersteller = Artikelbezeichnung (balance)

  type StoreType @default(rady_insole)

  userId String
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  adminStoreId String?
  adminStore   admin_store? @relation(fields: [adminStoreId], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  storesHistory         StoresHistory[] // History of stock changes
  versorgungen          Versorgungen[]
  customerOrders        customerOrders[]
  customerVersorgungens customer_versorgungen[]
  storeOrderOverviews   StoreOrderOverview[]
  adminStoreTrackings   admin_store_tracking[]
  adminOrderTransitions admin_order_transitions[]

  @@index([id, produktname])
  @@map("stores")
}

enum StoreType {
  milling_block
  rady_insole
}

enum CreateStatus {
  by_self
  by_admin
}

model StoreOrderOverview {
  id String @id @default(uuid())

  storeId String
  store   Stores @relation(fields: [storeId], references: [id], onDelete: Cascade)

  partnerId String
  partner   User?  @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  size                Int
  length              Float
  quantity            Int
  auto_order_limit    Int
  auto_order_quantity Int

  status StoreOrderOverviewStatus?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum StoreOrderOverviewStatus {
  In_bearbeitung
  Versendet
  Geliefert
  Storniert
}

model StoresHistory {
  id      String @id @default(uuid())
  storeId String
  store   Stores @relation(fields: [storeId], references: [id], onDelete: Cascade)

  changeType ChangeType
  quantity   Int?
  newStock   Int?
  reason     String?
  text       String?

  partnerId String
  user      User   @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  customerId String? // Optional: Link to customer if applicable
  customer   customers? @relation(fields: [customerId], references: [id], onDelete: SetNull)

  orderId String? // Optional: Link to order if applicable
  order   customerOrders? @relation("OrderStoresHistory", fields: [orderId], references: [id], onDelete: SetNull)

  status StoresHistoryStatus?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([storeId])
  @@index([partnerId])
  @@index([createdAt])
  @@index([customerId])
  @@index([orderId])
  @@map("storeshistory")
}

enum StoresHistoryStatus {
  SELL_OUT
  STOCK_UPDATE
}

enum ChangeType {
  // INCOMING // e.g., deliveries
  // OUTGOING // e.g., sales, reservations
  // CORRECTION // manual adjustments
  // TRANSFER // between storage locations 
  sales
  createStock
  updateStock
}

model stock_material {
  id String @id @default(uuid())

  partnerId String
  partner   User   @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  manufacturer      String?
  delivery_business String?
  article           String?
  ein               String?
  quantity          Int?
  value             Float?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

/**
 * ----------------------------------------------------------------------
 * ============================Store end=================================
 */
model Bestellubersicht {
  id     String @id @default(uuid())
  number Int

  userId String @unique
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

//===============================massschuhe_order=================================
/**
 * @massschuhe_order "This is the main part of our application"
 * এটা হচ্চে জুতার অর্ডার মডেল
 * Q. how to order a shooe a customer?
 * A. every spapic partner has her own customer database. every customer has spapic insole and foot analysis and shoe.
 */

//  ================= V1========================
model massschuhe_order {
  id String @id @default(uuid())

  orderNumber Int?

  arztliche_diagnose    String?
  usführliche_diagnose String?
  rezeptnummer          String?
  durchgeführt_von     String?
  note                  String?

  albprobe_geplant   Boolean? @default(false)
  kostenvoranschlag  Boolean? @default(false)
  //-------------------------------------------------
  //workload section
  delivery_date      String?
  telefon            String?
  filiale            Json? //location - accepts any JSON data
  kunde              String? //customer name
  email              String?
  button_text        String?
  // PREISAUSWAHL
  fußanalyse        Float?
  einlagenversorgung Float?

  bodenerstellungpdf String?
  geliefertpdf       String?

  customer_note String?
  location      String?
  //-------------------------------------------------
  status        massschuhe_order_status @default(Leistenerstellung)
  express       Boolean?                @default(false)

  bezahlt paymnentStatus?

  //-------------------------------------------------
  cashNites     String?
  //
  isByPartner_1 Boolean? @default(false)
  isByPartner_2 Boolean? @default(false)

  production_startedAt DateTime?

  //relation with users
  userId String?
  user   User?   @relation(fields: [userId], references: [id], onDelete: SetNull)

  employeeId String?
  employee   Employees? @relation(fields: [employeeId], references: [id], onDelete: SetNull)

  customerId String?
  customer   customers? @relation(fields: [customerId], references: [id], onDelete: SetNull)

  createdAt                 DateTime                     @default(now())
  updatedAt                 DateTime                     @updatedAt
  massschuheOrderHistories  massschuhe_order_history[]
  massschuheOrderInsurances massschuhe_order_insurance[]
  // massschuheOrderAdmin1s   massschuhe_order_admin_1[]
  customShafts              custom_shafts[]
  adminOrderTransitions     admin_order_transitions[]

  isPanding       Boolean?         @default(false)
  courierContacts CourierContact[]
  customModels    custom_models[]
  ordersFeedbacks ordersFeedback[]

  @@unique([userId, orderNumber]) // Unique per partner
  @@index([createdAt])
  @@index([updatedAt])
}

enum massschuhe_order_status {
  Leistenerstellung //started

  Bettungsherstellung
  Halbprobenerstellung
  Schafterstellung
  Bodenerstellung

  Geliefert
}

model massschuhe_order_insurance {
  id String @id @default(uuid())

  orderId String
  order   massschuhe_order @relation(fields: [orderId], references: [id], onDelete: Cascade)

  price Float?

  description Json?

  vat_country String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([orderId])
  @@index([price])
  @@index([description])
  @@index([createdAt])
  @@index([updatedAt])
}

model massschuhe_order_history {
  id String @id @default(uuid())

  statusFrom massschuhe_order_status?
  statusTo   massschuhe_order_status

  note String?

  startedAt  DateTime? // when the step begins
  finishedAt DateTime? // when the step is finished

  orderdAt           DateTime?        @default(now())
  massschuhe_orderId String
  massschuhe_order   massschuhe_order @relation(fields: [massschuhe_orderId], references: [id], onDelete: Cascade)

  partnerId String?
  partner   User?   @relation(fields: [partnerId], references: [id], onDelete: SetNull)

  employeeId String?
  employee   Employees? @relation(fields: [employeeId], references: [id], onDelete: SetNull)

  customerId String?
  customer   customers? @relation(fields: [customerId], references: [id], onDelete: SetNull)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([createdAt])
  @@index([massschuhe_orderId])
  @@index([partnerId])
  @@index([employeeId])
  @@index([customerId])
}

//  ===================== V2 ======================
model shoe_order {
  id String @id @default(uuid())

  orderNumber Int?
  priority    Priority? @default(Normal)
  quantity    Int?

  busness_location Json? // { title: string, description?: string }
  payment_status   paymnentStatus?

  //Ärztliche Diagnose (1st fields)
  medical_diagnosis        String?
  // Versorgung laut Arzt (2nd fields)
  care_according_to_doctor String?
  // 3rd fields
  total_price              Float?
  // 4th fields

  // -- RELATIONS
  customerId String?
  customer   customers? @relation(fields: [customerId], references: [id], onDelete: SetNull)

  partnerId String?
  partner   User?   @relation(fields: [partnerId], references: [id], onDelete: SetNull)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

//---------------------------------------------------------------------------
//এর উদ্দেশ্য হচ্ছে পার্টনার থেক কাষ্টমারের ওইয়ার্ডার অ্যাাডমিন কে পাঠানো
/**
 * @ maßschaft_kollektion হচ্ছে অ্যাাডমিন প্যানেল থেকে কিছু জুতা তৌরি করেই রাখবে! যখন কাষ্টমার order করবে তখন সেই জুতা এই মডেল থেকে নিবে!
 * @ custom_shafts হচ্ছে যখন ধরো পার্টনারের পোডাকশনে এই জুতা যেই যেটা তার কাষ্টমার চাচ্ছে। এখন পার্টনার maßschaft_kollektion থেকে জুতা বাছাই করে কাষ্টমারের বর্ত্মন ওইয়ার্ডারকে কমপ্লিট করবে।
 */
//---------------------------------------------------------------------------
model maßschaft_kollektion {
  id String @id @default(uuid())

  ide String?

  name        String? // জুতার নাম
  image       String? // জুতার ছবি
  price       Float? // মূল্য
  catagoary   String? // ক্যাটাগরি
  gender      String? // লিঙ্গ
  description String? // বিস্তারিত বিবরণ

  // Model A → default: Eyelets only
  // Model B → default: Eyelets + zipper
  // Model C → default: Velcro + zipper
  verschlussart String? // ধরন

  customShafts custom_shafts[] // এই জুতার উপর ভিত্তি করে তৈরি হওয়া কাস্টমাইজড অর্ডারসমূহ

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([name]) // For search optimization
  @@index([catagoary]) // For search optimization
  @@index([gender]) // For search optimization
}

model custom_shafts {
  id String @id @default(uuid())

  /**
   * cএটা সব খানে আছে
   * -------------------------------------------------------------------------------------------
   * -------------------------------------------------------------------------------------------
   */

  orderNumber           String?
  other_customer_number String?
  other_customer_name   String?

  customerId String?
  invoice    String?

  totalPrice Float?

  // common for (Halbprobenerstellung || Massschafterstellung)
  image3d_1 String?
  image3d_2 String?

  isCustomeModels Boolean? @default(false)
  // if isCustomeModels is true then we dont need to add the massschuhe_order_id

  /**
   * Halbprobenerstellung Started ওইয়ার্ডার ১
   * --------------------------------------------------------------------------
   * --------------------------------------------------------------------------
   */
  Halbprobenerstellung_json Json?
  /**
   * soll_die_bettung_neutral_oder_korrigierend String?
   * Bettungsdicke                              String?
   * Haertegrad_Shore       String?
   * Haertegrad_Shore_price Float?
   * Fersenschale          String?
   * Laengsgewölbestütze String?
   * soll_eine_pelotte_oder_querpelotte String?
   * Korrektur_der_Fußstellung         String?
   * Zehenelemente                      String?
   * wenn_eine_korrektur_nötig_ist                     String?
   * gibt_es_ein_spezielles_fußproblem_das_wir_bei_der String?
   * vertiefungen_aussparungen String?
   * zusatzkorrekturen       String?
   * zusatzkorrekturen_price Float?
   * Oberfläche_finish       String?
   * Oberfläche_finish_price Float?
   * Uberzug       String?
   * Uberzug_price Float?
   * hast_du_sonstige_anmerkungen_oder_wünsche_zu_der_bettung String?
   * // Leistenkonfigurator
   * soll_der_leisten_mit_oder_ohne_platzhalter_fuer_die_bettung String?
   * Schuhleisten_typ       String?
   * Schuhleisten_typ_price Float?
   * material_des_leisten       String?
   * material_des_leisten_price Float?
   * soll_beide_leisten_die_gleiche_länge_haben String?
   * absatzhöhe                                 String?
   * abrollhilfe                                 String?
   * gibt_es_spezielle_fußprobleme_die_wir_bei_der_fertigung String?
   * hast_du_sonstige_anmerkungen_oder_wünsche_zum_leisten   String?
   */

  /**
   * Massschafterstellung Ended
   * --------------------------------------------------------------------------
   * --------------------------------------------------------------------------
   */

  /**
   * Massschafterstellung Started ওইয়ার্ডার ২
   * --------------------------------------------------------------------------
   * --------------------------------------------------------------------------
   */

  Massschafterstellung_json1 Json?
  ledertyp_image             String?
  zipper_image               String?
  paintImage                 String?
  versenden                  Json?

  Massschafterstellung_json2 Json?
  invoice2                   String?

  //---------------------- fiRST Page------------
  /**
   * /**
   * /**
   * /**
   * /**
   * /**
   * /**
   * /**
   * /**
   * /**
   * /**
   * kategorie String?
   * // এখানে লেদার টাইপ এর উপর ভিত্তি করে ইমেইজ হবে আর একটা json হবে
   * ledertyp              String?
   * // Ledertypen den Schuhbereichen zuordnen
   * ledertypen_definieren Json?
   * nzahl_der_ledertypen String?
   * Innenfutter          String?
   * lederfarbe           String?
   * schafthöhe          String?
   * polsterung           String?
   * verstärkungen       String?
   * //এখানে হিতা তে হিপার হবে কিনা! জিপার থাকলে ইমেইজ হবে
   * // বা জুতার ধরণ হবে এখানে Zipper, Eyelets, Velcro এর মধ্যে হবে
   * //যদি Zipper হবে তাহলে এখানে জিপার ইমেইজ হবে
   * verschlussart String? // Zipper, Eyelets, Velcro
   * moechten_sie_passende_schnuersenkel_zum_schuh       String? //Reißverschluss (Zipper), Ösen,
   * moechten_sie_passende_schnuersenkel_zum_schuh_price Float?
   * moechten_sie_den_schaft_bereits_mit_eingesetzten_oesen       String? //Reißverschluss (Zipper), Ösen,
   * moechten_sie_den_schaft_bereits_mit_eingesetzten_oesen_price Float?
   */

  //------------------------second page------------------------
  /**
   * /**
   * /**
   * /**
   * /**
   * /**
   * /**
   * /**
   * /**
   * /**
   * /**
   * //এই পেইজে একটা জুতার তলার ছবি আছে
   * hinterkappe String?
   * leder_auswahl       String?
   * leder_auswahl_price Float?
   * Kknstruktionsart       String?
   * Kknstruktionsart_price Float?
   * brandsohle       String?
   * brandsohle_price Float?
   * ohlenmaterial String?
   * absatz_höhe_am_besten_wie_bei_leisten_beachten String?
   * abrollhilfe_Rolle String?
   * absatz_form_chtung_bitte_achten_Sohle_beachten_ob_möglich String?
   * linker_schuh_left_Shoe String?
   * rechter_schuh_right_Shoe String?
   * öchten_Sie_die_Laufsohle_lose_der_Bestellung_beilegen String?
   * öchten_Sie_die_Laufsohle_lose_der_Bestellung_beilegen_price Float?
   * esondere_hinweise String?
   */
  //---------------------------------------------------------------
  //------------------------SECOND ORDER COMPLATE------------------------

  /**
   * Massschafterstellung Ended
   * --------------------------------------------------------------------------
   * --------------------------------------------------------------------------
   */

  /**
   * Bodenkonstruktion Started ওইয়ার্ডার ৩
   * --------------------------------------------------------------------------
   * --------------------------------------------------------------------------
   */
  bodenkonstruktion_json    Json?
  staticImage               String?
  customerName              String?
  deliveryDate              DateTime?
  isCustomBodenkonstruktion Boolean?  @default(false)
  /**
   * Bodenkonstruktion Ended
   * --------------------------------------------------------------------------
   * --------------------------------------------------------------------------
   */

  //relation-------------------------------------------------
  maßschaftKollektionId String?
  maßschaft_kollektion  maßschaft_kollektion? @relation(fields: [maßschaftKollektionId], references: [id]) // সংশ্লিষ্ট বেস জুতা
  customer               customers?             @relation(fields: [customerId], references: [id]) // সংশ্লিষ্ট কাস্টমার

  partnerId String? // পার্টনার আইডি
  user      User?   @relation(fields: [partnerId], references: [id], onDelete: SetNull) // সংশ্লিষ্ট পার্টনার ইউজার

  //relation with shoes
  massschuhe_order_id String?
  massschuhe_order    massschuhe_order? @relation(fields: [massschuhe_order_id], references: [id], onDelete: SetNull)

  status custom_shafts_status? @default(Neu)

  catagoary custom_shafts_catagoary?

  // isCompleted Boolean? @default(false)
  order_status admin_order_status? @default(active)

  createdAt             DateTime                  @default(now())
  updatedAt             DateTime                  @updatedAt
  customModels          custom_models[]
  adminOrderTransitions admin_order_transitions[]
  courierContacts       CourierContact[]

  @@index([status]) // স্ট্যাটাস অনুসারে দ্রুত সার্চের জন্য
  @@index([customerId]) // কাস্টমার অনুসারে দ্রুত সার্চের জন্য
  @@index([maßschaftKollektionId]) // বেস জুতা অনুসারে দ্রুত সার্চের জন্য
  @@index([partnerId]) // পার্টনার অনুসারে দ্রুত সার্চের জন্য
  @@index([createdAt]) // তারিখ অনুসারে দ্রুত সার্চের জন্য
  @@index([catagoary]) // Category filtering
  @@index([order_status]) // Completion status filtering
  @@index([catagoary, status]) // Composite: category + status (most common filter)
  @@index([catagoary, createdAt]) // Composite: category + date sorting
  @@index([partnerId, catagoary]) // Composite: partner + category
  @@index([status, createdAt]) // Composite: status + date sorting
  @@index([orderNumber]) // Order number search
  @@index([other_customer_number]) // Customer number search
  @@index([massschuhe_order_id]) // Order relation lookup
}

enum admin_order_status {
  active
  canceled
  completed
}

enum custom_shafts_catagoary {
  //স্টেপ ১
  Halbprobenerstellung
  //স্টেপ ২
  Massschafterstellung
  //স্টেপয়ার ৩
  Bodenkonstruktion

  Komplettfertigung

  // এটা কোন স্টেপ না সরাসরি ওইয়ার্ডার করার জন্য ব্যবহার হয়।
  row
}

enum custom_shafts_status {
  Neu
  Zu_Produzent_abgeschickt
  In_Bearbeitung
  Zu_Kunde_abgeschickt
  Bei_uns_angekommen
  Beim_Kunden_angekommen

  Bestellung_eingegangen
  In_Produktiony
  Qualitätskontrolle
  Versandt
  Ausgeführt
}

model custom_models {
  id               String @id @default(cuid())
  // id Int @id @default(autoincrement())
  custom_models_id Int?   @unique

  custom_models_name          String?
  custom_models_image         String?
  custom_models_price         Float?
  custom_models_verschlussart String?
  custom_models_gender        String?
  custom_models_description   String?

  partnerId String?
  partner   User?   @relation(fields: [partnerId], references: [id], onDelete: SetNull)

  customerId String?
  customer   customers? @relation(fields: [customerId], references: [id], onDelete: SetNull)

  //relation with shoes
  custom_shafts_id String?
  custom_shafts    custom_shafts? @relation(fields: [custom_shafts_id], references: [id], onDelete: SetNull)

  createdAt          DateTime          @default(now())
  updatedAt          DateTime          @updatedAt
  massschuheOrder    massschuhe_order? @relation(fields: [massschuhe_orderId], references: [id])
  massschuhe_orderId String?
}

model damian_count {
  id    String @id @default(cuid())
  count Int    @default(0)
}

/**
 * date when created the order
 * name of the customer if this transitions related with customer
 * status (panding and complated) handle form admin panal
 */

model admin_order_transitions {
  id                String  @id @default(uuid())
  orderNumber       String?
  transitionsNumber String?

  status   admin_order_transitions_status @default(panding)
  orderFor transitions_for?

  /**
   * if transitions for shoes
   */
  massschuhe_order_id     String?
  custom_shafts_catagoary custom_shafts_catagoary?
  massschuhe_order        massschuhe_order?        @relation(fields: [massschuhe_order_id], references: [id], onDelete: SetNull)

  custom_shafts_id String?
  custom_shafts    custom_shafts? @relation(fields: [custom_shafts_id], references: [id], onDelete: SetNull)

  customerId String?
  customer   customers? @relation(fields: [customerId], references: [id], onDelete: SetNull)

  /**
   * if transitions for store
   */
  storeId String?
  store   Stores? @relation(fields: [storeId], references: [id], onDelete: SetNull)

  price Float?
  note  String?

  partnerId String?
  partner   User?   @relation(fields: [partnerId], references: [id], onDelete: SetNull)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([custom_shafts_id])
  @@index([massschuhe_order_id])
  @@index([storeId])
  @@index([partnerId])
  @@index([orderFor])
  @@index([createdAt])
  @@index([partnerId, orderNumber]) // Composite index for fast orderNumber lookup per partner
  // High-scale indexes for getAllTransitions (billions of rows, thousands of concurrent users)
  @@index([partnerId, createdAt(sort: Desc)]) // Main list + cursor pagination
  @@index([partnerId, status, createdAt(sort: Desc)]) // With status filter
  @@index([partnerId, orderFor, createdAt(sort: Desc)]) // With orderFor filter
  @@index([partnerId, id]) // Fast cursor lookup by id
}

enum admin_order_transitions_status {
  panding
  complated
}

enum transitions_for {
  insole
  shoes
  store
}

model CourierContact {
  id String @id @default(uuid())

  partnerId String?
  partner   User?   @relation(fields: [partnerId], references: [id], onDelete: SetNull)

  orderId String?
  order   massschuhe_order? @relation(fields: [orderId], references: [id], onDelete: SetNull)

  custom_shafts_id String?
  custom_shafts    custom_shafts? @relation(fields: [custom_shafts_id], references: [id], onDelete: SetNull)

  customerId String?
  customer   customers? @relation(fields: [customerId], references: [id], onDelete: SetNull)

  address     Json?
  companyName String?
  phone       String?
  email       String?
  price       Float?  @default(13)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([custom_shafts_id])
}

//==================================Massschuhe Order Ended==========================================

model FeatureAccess {
  id String @id @default(uuid())

  partnerId String @unique
  partner   User   @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  // Dashboard Section
  dashboard           Boolean @default(true)
  teamchat            Boolean @default(true)
  kundensuche         Boolean @default(true)
  neukundenerstellung Boolean @default(true)
  einlagenauftrage    Boolean @default(true)
  massschuhauftrage   Boolean @default(true)
  massschafte         Boolean @default(true)

  // Product Management
  produktverwaltung      Boolean @default(true)
  sammelbestellungen     Boolean @default(true)
  nachrichten            Boolean @default(true)
  terminkalender         Boolean @default(true)
  monatsstatistik        Boolean @default(true)
  mitarbeitercontrolling Boolean @default(true)
  einlagencontrolling    Boolean @default(true)
  fusubungen             Boolean @default(true)
  musterzettel           Boolean @default(true)
  einstellungen          Boolean @default(true)
  account_settings       Boolean @default(true)

  news_and_aktuelles Boolean @default(true)
  produktkatalog     Boolean @default(true)
  balance            Boolean @default(true)

  /**
   * title: Automatisierte Nachrichten
   * /dashboard/automatisierte-nachrichten
   * title: Kasse & Abholungen
   * /dashboard/kasse
   * title: Finanzen & Kasse
   * /dashboard/finanzen-kasse
   * title: Einnahmen & Rechnungen
   * /dashboard/einnahmen
   */
  automatisierte_nachrichten Boolean @default(true)
  kasse_and_abholungen       Boolean @default(true)
  finanzen_and_kasse         Boolean @default(true)
  einnahmen_and_rechnungen   Boolean @default(true)
  statistiken                Boolean @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([partnerId])
  @@index([createdAt])
  @@index([updatedAt])
  @@map("feature_access")
}

model employee_feature_access {
  id String @id @default(uuid())

  employeeId String
  employee   Employees @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  partnerId String
  partner   User   @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  // Dashboard Section
  dashboard           Boolean @default(false)
  teamchat            Boolean @default(false)
  kundensuche         Boolean @default(false)
  neukundenerstellung Boolean @default(false)
  einlagenauftrage    Boolean @default(false)
  massschuhauftrage   Boolean @default(false)
  massschafte         Boolean @default(false)

  // Product Management
  produktverwaltung      Boolean @default(false)
  sammelbestellungen     Boolean @default(false)
  nachrichten            Boolean @default(false)
  terminkalender         Boolean @default(false)
  monatsstatistik        Boolean @default(false)
  mitarbeitercontrolling Boolean @default(false)
  einlagencontrolling    Boolean @default(false)
  fusubungen             Boolean @default(false)
  musterzettel           Boolean @default(false)
  einstellungen          Boolean @default(false)
  account_settings       Boolean @default(false)

  news_and_aktuelles Boolean @default(false)
  produktkatalog     Boolean @default(false)
  balance            Boolean @default(false)

  automatisierte_nachrichten Boolean @default(false)
  kasse_and_abholungen       Boolean @default(false)
  finanzen_and_kasse         Boolean @default(false)
  einnahmen_and_rechnungen   Boolean @default(false)
  statistiken                Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([employeeId, partnerId])
  @@index([employeeId])
  @@index([partnerId])
}

model notification {
  id String @id @default(uuid())

  type notificationType?

  partnerId String
  user      User   @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  message String
  eventId String?
  route   String?
  isRead  Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum notificationType {
  Appointment_Reminder
  Appointment_Created
  updated_massschuhe_order_status
  admin_order_canceled
  shop_interest
  test
}

model software_version {
  id String @id @default(uuid())

  version     String
  releaseDate DateTime
  title       String?
  description Json?

  isNewest Boolean @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([releaseDate])
}

//--------------------------------------------------------
//----------------------ALL settings----------------------
//--------------------------------------------------------

model partners_settings {
  id String @id @default(uuid())

  partnerId String @unique
  partner   User   @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  orthotech Boolean @default(false)
  opannrit  Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([partnerId])
  @@index([createdAt])
  @@index([updatedAt])
  @@map("partners_settings")
}

model order_settings {
  id        Int      @id @default(autoincrement())
  updatedAt DateTime @updatedAt

  // 1
  autoCalcPelottePos Boolean @default(true)

  // 2
  autoSendToProd Boolean @default(false)

  // 3 - attach scans to order
  attachFootScans Boolean @default(true)

  // 4 - include basic meas. points 10+11
  showMeasPoints10_11 Boolean @default(false)

  // 5 - actually print the foot scans
  printFootScans Boolean @default(true)

  // 6 - detailed / extended meas. points 10+11
  showMeasPoints10_11_Det Boolean @default(false)

  // Optional: multi-company support
  partnerId String? @unique
  partner   User?   @relation(fields: [partnerId], references: [id], onDelete: SetNull)

  @@index([partnerId])
  @@index([updatedAt])
  @@map("order_settings")
}

//--------------------------------------------------------
//-----------------------settings end---------------------
//--------------------------------------------------------

model partner_conversation {
  id String @id @default(uuid())

  name             String?
  image            String?
  conversationType conversationType @default(Private)

  partnerId String
  partner   User   @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  members  partner_conversation_members[]
  messages partner_conversation_message[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([partnerId])
  @@index([createdAt])
}

enum conversationType {
  Private
  Group
}

model partner_conversation_members {
  id String @id @default(uuid())

  conversationId String
  conversation   partner_conversation @relation(fields: [conversationId], references: [id], onDelete: Cascade)

  // Member can be either PARTNER or EMPLOYEE
  partnerId String?
  partner   User?   @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  employeeId String?
  employee   Employees? @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  role memberRole

  isPartner Boolean @default(false)
  // isMuted Boolean @default(false)
  // isArchived Boolean @default(false)
  isDeleted Boolean @default(false)

  joinedAt  DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([conversationId, partnerId, employeeId])
  @@index([conversationId])
  @@index([partnerId])
  @@index([employeeId])
}

enum memberRole {
  Partner
  Employee
}

model partner_conversation_message {
  id String @id @default(uuid())

  conversationId String
  conversation   partner_conversation @relation(fields: [conversationId], references: [id], onDelete: Cascade)

  // Sender can be either PARTNER or EMPLOYEE
  senderPartnerId String?
  senderPartner   User?   @relation(fields: [senderPartnerId], references: [id], onDelete: SetNull)

  senderEmployeeId String?
  senderEmployee   Employees? @relation(fields: [senderEmployeeId], references: [id], onDelete: SetNull)

  // For multiple replies - self-relation for chaining replies
  repliedToMessageIds String[]

  senderType messageSenderType // PARTNER or EMPLOYEE

  content     String
  messageType messageType @default(Normal)

  // Message status
  isEdited Boolean @default(false)
  isRead   Boolean @default(false)

  deletedAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([conversationId])
  @@index([senderPartnerId])
  @@index([senderEmployeeId])
  @@index([createdAt])
}

enum messageSenderType {
  Partner
  Employee
}

enum messageType {
  Normal
  System
}

/**
 * it's news created by admin for partner
 * image, title, subtitle, short description full subscription
 */
model news {
  id String @id @default(uuid())

  image            String
  title            String
  subtitle         String
  shortDescription String
  fullSubscription String

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([image])
  @@index([title])
  @@index([subtitle])
  @@index([createdAt])
  @@index([updatedAt])
}

model feetf1rst_shop {
  id String @id @default(uuid())

  category      String?
  title         String?
  price         Float?
  quantity      Int?
  delivery_time String?

  system_description String? //just inly 12 word of description
  description        String?

  image String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  //relationa
  feetf1RstShopInterests feetf1rst_shop_interests[]
}

model feetf1rst_shop_interests {
  id String @id @default(uuid())

  question String?

  partnerId String
  partner   User   @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  feetf1rst_shop_id String
  feetf1rst_shop    feetf1rst_shop @relation(fields: [feetf1rst_shop_id], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([partnerId])
  @@index([feetf1rst_shop_id])
}

//vat
model government_vat {
  id String @id @default(uuid())

  country     vat_country?
  rate        Float?
  description String?

  createdAt DateTime @default(now())
}

enum vat_country {
  Deutschland
  Österreich
  Italien
  Schweiz
  Frankreich
  Niederlande
}
